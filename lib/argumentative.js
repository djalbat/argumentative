'use strict';

var stringUtilities = require('./utilities/string');

var toCamelCase = stringUtilities.toCamelCase;


function parseArgv(argv, abbreviations) {
  var interpreterPath = argv[0],
      filePath = argv[1],
      args = argv.slice(2),
      ///
  commands = [],
      optionMap = {},
      optionAbbreviationMap = abbreviations || {};

  args.forEach(function (argument) {
    ///
    var abbreviatedOptions = /^-[^-]+$/.test(argument),
        unabbreviatedOption = /^--[^-].+$/.test(argument);

    if (false) {
      ///
    } else if (abbreviatedOptions) {
      var index = argument.indexOf('=');

      if (index === -1) {
        var _optionNames = argument.split('');

        _optionNames.shift();

        _optionNames.forEach(function (optionName) {
          var optionValue = true;

          optionMap[optionName] = optionValue;
        });
      } else {
        var _optionNames2 = argument.substring(1, index).split(''),
            optionNamesLength = _optionNames2.length,
            lastOptionIndex = optionNamesLength - 1,
            lastOptionValue = argument.substring(index + 1);

        _optionNames2.forEach(function (optionName, index) {
          var optionValue = index === lastOptionIndex ? lastOptionValue : true;

          optionMap[optionName] = optionValue;
        });
      }
    } else if (unabbreviatedOption) {
      var optionName = void 0,
          optionValue = void 0;

      var _index = argument.indexOf('=');

      if (_index === -1) {
        optionName = argument.substring(2);

        optionValue = true;
      } else {
        optionName = argument.substring(2, _index);

        optionValue = argument.substring(_index + 1);
      }

      optionMap[optionName] = optionValue;
    } else {
      var command = argument; ///

      commands.push(command);
    }
  });

  var abbreviatedOptionNames = Object.keys(optionAbbreviationMap); ///

  abbreviatedOptionNames.forEach(function (abbreviatedOptionName) {
    if (optionMap.hasOwnProperty(abbreviatedOptionName)) {
      var unAbbreviatedOptionName = optionAbbreviationMap[abbreviatedOptionName];

      if (optionMap.hasOwnProperty(unAbbreviatedOptionName)) {
        ///
      } else {
        optionMap[unAbbreviatedOptionName] = optionMap[abbreviatedOptionName];
      }

      delete optionMap[abbreviatedOptionName];
    }
  });

  var optionNames = Object.keys(optionMap),
      options = optionNames.reduce(function (options, optionName) {
    var optionValue = optionMap[optionName];

    optionName = toCamelCase(optionName); ///

    options[optionName] = optionValue;

    return options;
  }, {});

  return {
    args: args,
    options: options,
    commands: commands,
    filePath: filePath,
    interpreterPath: interpreterPath
  };
}

module.exports = {
  parseArgv: parseArgv
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2VzNi9hcmd1bWVudGF0aXZlLmpzIl0sIm5hbWVzIjpbInN0cmluZ1V0aWxpdGllcyIsInJlcXVpcmUiLCJ0b0NhbWVsQ2FzZSIsInBhcnNlQXJndiIsImFyZ3YiLCJhYmJyZXZpYXRpb25zIiwiaW50ZXJwcmV0ZXJQYXRoIiwiZmlsZVBhdGgiLCJhcmdzIiwic2xpY2UiLCJjb21tYW5kcyIsIm9wdGlvbk1hcCIsIm9wdGlvbkFiYnJldmlhdGlvbk1hcCIsImZvckVhY2giLCJhcmd1bWVudCIsImFiYnJldmlhdGVkT3B0aW9ucyIsInRlc3QiLCJ1bmFiYnJldmlhdGVkT3B0aW9uIiwiaW5kZXgiLCJpbmRleE9mIiwib3B0aW9uTmFtZXMiLCJzcGxpdCIsInNoaWZ0Iiwib3B0aW9uTmFtZSIsIm9wdGlvblZhbHVlIiwic3Vic3RyaW5nIiwib3B0aW9uTmFtZXNMZW5ndGgiLCJsZW5ndGgiLCJsYXN0T3B0aW9uSW5kZXgiLCJsYXN0T3B0aW9uVmFsdWUiLCJjb21tYW5kIiwicHVzaCIsImFiYnJldmlhdGVkT3B0aW9uTmFtZXMiLCJPYmplY3QiLCJrZXlzIiwiYWJicmV2aWF0ZWRPcHRpb25OYW1lIiwiaGFzT3duUHJvcGVydHkiLCJ1bkFiYnJldmlhdGVkT3B0aW9uTmFtZSIsIm9wdGlvbnMiLCJyZWR1Y2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxrQkFBa0JDLFFBQVEsb0JBQVIsQ0FBeEI7O0lBRVFDLFcsR0FBZ0JGLGUsQ0FBaEJFLFc7OztBQUVSLFNBQVNDLFNBQVQsQ0FBbUJDLElBQW5CLEVBQXlCQyxhQUF6QixFQUF3QztBQUN2QyxNQUFNQyxrQkFBa0JGLEtBQUssQ0FBTCxDQUF4QjtBQUFBLE1BQ0dHLFdBQVdILEtBQUssQ0FBTCxDQURkO0FBQUEsTUFFT0ksT0FBT0osS0FBS0ssS0FBTCxDQUFXLENBQVgsQ0FGZDtBQUFBLE1BRThCO0FBQ3ZCQyxhQUFXLEVBSGxCO0FBQUEsTUFJT0MsWUFB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LFVBQVYsRUFBeUI7QUFDckQsUUFBTUMsY0FBY2IsVUFBVVksVUFBVixDQUFwQjs7QUFFQ0EsaUJBQWFyQixZQUFZcUIsVUFBWixDQUFiLENBSG9ELENBR2Q7O0FBRXRDZSxZQUFRZixVQUFSLElBQXNCQyxXQUF0Qjs7QUFFQSxXQUFPYyxPQUFQO0FBQ0QsR0FSUyxFQVFQLEVBUk8sQ0FEaEI7O0FBV0QsU0FBUTtBQUNQOUIsY0FETztBQUVMOEIsb0JBRks7QUFHUDVCLHNCQUhPO0FBSVBILHNCQUpPO0FBS1BEO0FBTE8sR0FBUjtBQU9BOztBQUVEa0MsT0FBT0MsT0FBUCxHQUFpQjtBQUNmdEM7QUFEZSxDQUFqQiIsImZpbGUiOiJhcmd1bWVudGF0aXZlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBzdHJpbmdVdGlsaXRpZXMgPSByZXF1aXJlKCcuL3V0aWxpdGllcy9zdHJpbmcnKTtcblxuY29uc3QgeyB0b0NhbWVsQ2FzZSB9ID0gc3RyaW5nVXRpbGl0aWVzO1xuXG5mdW5jdGlvbiBwYXJzZUFyZ3YoYXJndiwgYWJicmV2aWF0aW9ucykge1xuXHRjb25zdCBpbnRlcnByZXRlclBhdGggPSBhcmd2WzBdLFxuXHRcdFx0XHRmaWxlUGF0aCA9IGFyZ3ZbMV0sXG4gICAgICAgIGFyZ3MgPSBhcmd2LnNsaWNlKDIpLCAgLy8vXG4gICAgICAgIGNvbW1hbmRzID0gW10sXG4gICAgICAgIG9wdGlvbk1hcCA9IHt9LFxuICAgICAgICBvcHRpb25BYmJyZXZpYXRpb25NYXAgPSBhYmJyZXZpYXRpb25zIHx8IHt9O1xuXG5cdGFyZ3MuZm9yRWFjaCgoYXJndW1lbnQpID0+IHsgIC8vL1xuXHRcdGNvbnN0IGFiYnJldmlhdGVkT3B0aW9ucyA9IC9eLVteLV0rJC8udGVzdChhcmd1bWVudCksXG4gICAgICAgICAgdW5hYmJyZXZpYXRlZE9wdGlvbiA9IC9eLS1bXi1dLiskLy50ZXN0KGFyZ3VtZW50KTtcblxuXHRcdGlmIChmYWxzZSkge1xuXHRcdCAgLy8vXG4gICAgfSBlbHNlIGlmIChhYmJyZXZpYXRlZE9wdGlvbnMpIHtcbiAgICAgIGNvbnN0IGluZGV4ID0gYXJndW1lbnQuaW5kZXhPZignPScpO1xuXG4gICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbk5hbWVzID0gYXJndW1lbnQuc3BsaXQoJycpO1xuXG4gICAgICAgIG9wdGlvbk5hbWVzLnNoaWZ0KCk7XG5cbiAgICAgICAgb3B0aW9uTmFtZXMuZm9yRWFjaCgob3B0aW9uTmFtZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG9wdGlvblZhbHVlID0gdHJ1ZTtcblxuICAgICAgICAgIG9wdGlvbk1hcFtvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uTmFtZXMgPSBhcmd1bWVudC5zdWJzdHJpbmcoMSwgaW5kZXgpLnNwbGl0KCcnKSxcbiAgICAgICAgICAgICAgb3B0aW9uTmFtZXNMZW5ndGggPSBvcHRpb25OYW1lcy5sZW5ndGgsXG4gICAgICAgICAgICAgIGxhc3RPcHRpb25JbmRleCA9IG9wdGlvbk5hbWVzTGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgbGFzdE9wdGlvblZhbHVlID0gYXJndW1lbnQuc3Vic3RyaW5nKGluZGV4ICsgMSk7XG5cbiAgICAgICAgb3B0aW9uTmFtZXMuZm9yRWFjaCgob3B0aW9uTmFtZSwgaW5kZXgpID0+IHtcbiAgICAgICAgICBjb25zdCBvcHRpb25WYWx1ZSA9IChpbmRleCA9PT0gbGFzdE9wdGlvbkluZGV4KSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RPcHRpb25WYWx1ZSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZTtcblxuICAgICAgICAgIG9wdGlvbk1hcFtvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHVuYWJicmV2aWF0ZWRPcHRpb24pIHtcblx0XHQgIGxldCBvcHRpb25OYW1lLCBvcHRpb25WYWx1ZTtcblxuXHRcdCAgY29uc3QgaW5kZXggPSBhcmd1bWVudC5pbmRleE9mKCc9Jyk7XG5cblx0XHQgIGlmIChpbmRleCA9PT0gLTEpIHtcblx0XHQgICAgb3B0aW9uTmFtZSA9IGFyZ3VtZW50LnN1YnN0cmluZygyKTtcblxuICAgICAgICBvcHRpb25WYWx1ZSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuXHRcdCAgICBvcHRpb25OYW1lID0gYXJndW1lbnQuc3Vic3RyaW5nKDIsIGluZGV4KTtcblxuXHRcdCAgICBvcHRpb25WYWx1ZSA9ICBhcmd1bWVudC5zdWJzdHJpbmcoaW5kZXggKyAxKTtcbiAgICAgIH1cblxuICAgICAgb3B0aW9uTWFwW29wdGlvbk5hbWVdID0gb3B0aW9uVmFsdWU7XG4gICAgfSBlbHNlIHtcblx0XHQgIGNvbnN0IGNvbW1hbmQgPSBhcmd1bWVudDsgLy8vXG5cbiAgICAgIGNvbW1hbmRzLnB1c2goY29tbWFuZCk7XG4gICAgfVxuXHR9KTtcblxuXHRjb25zdCBhYmJyZXZpYXRlZE9wdGlvbk5hbWVzID0gT2JqZWN0LmtleXMob3B0aW9uQWJicmV2aWF0aW9uTWFwKTsgIC8vL1xuXG4gIGFiYnJldmlhdGVkT3B0aW9uTmFtZXMuZm9yRWFjaCgoYWJicmV2aWF0ZWRPcHRpb25OYW1lKSA9PiB7XG4gICAgaWYgKG9wdGlvbk1hcC5oYXNPd25Qcm9wZXJ0eShhYmJyZXZpYXRlZE9wdGlvbk5hbWUpKSB7XG4gICAgICBjb25zdCB1bkFiYnJldmlhdGVkT3B0aW9uTmFtZSA9IG9wdGlvbkFiYnJldmlhdGlvbk1hcFthYmJyZXZpYXRlZE9wdGlvbk5hbWVdO1xuXG4gICAgICBpZiAob3B0aW9uTWFwLmhhc093blByb3BlcnR5KHVuQWJicmV2aWF0ZWRPcHRpb25OYW1lKSkge1xuICAgICAgICAvLy9cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9wdGlvbk1hcFt1bkFiYnJldmlhdGVkT3B0aW9uTmFtZV0gPSBvcHRpb25NYXBbYWJicmV2aWF0ZWRPcHRpb25OYW1lXTtcbiAgICAgIH1cblxuICAgICAgZGVsZXRlIG9wdGlvbk1hcFthYmJyZXZpYXRlZE9wdGlvbk5hbWVdO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3Qgb3B0aW9uTmFtZXMgPSBPYmplY3Qua2V5cyhvcHRpb25NYXApLFxuICAgICAgICBvcHRpb25zID0gb3B0aW9uTmFtZXMucmVkdWNlKChvcHRpb25zLCBvcHRpb25OYW1lKSA9PiB7XG5cdCAgICAgICAgY29uc3Qgb3B0aW9uVmFsdWUgPSBvcHRpb25NYXBbb3B0aW9uTmFtZV07XG5cbiAgICAgICAgICBvcHRpb25OYW1lID0gdG9DYW1lbENhc2Uob3B0aW9uTmFtZSk7IC8vL1xuXG4gICAgICAgICAgb3B0aW9uc1tvcHRpb25OYW1lXSA9IG9wdGlvblZhbHVlO1xuXG4gICAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgICAgIH0sIHt9KTtcblxuXHRyZXR1cm4gKHtcblx0XHRhcmdzLFxuICAgIG9wdGlvbnMsXG5cdFx0Y29tbWFuZHMsXG5cdFx0ZmlsZVBhdGgsXG5cdFx0aW50ZXJwcmV0ZXJQYXRoXG5cdH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcGFyc2VBcmd2XG59O1xuIl19